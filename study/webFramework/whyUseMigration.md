## 마이그레이션을 하는 이유

### 서버 환경
- 일반적으로 서버 환경은 로컬 환경, 검증 환경(= 개발서버), 프로덕션 환경으로 나뉜다.

#### 로컬환경
- 개인 컴퓨터에서 시스템의 코드를 개발하는 환경이다.
- 하나의 프로젝트에 여러명의 개발자가 참여하고 있다면, 각각의 개발자는 각각의 로컬 환경을 갖고 각자 담당하는 부분의 코드를 작성하게 된다.

#### 검증환경
- 로컬에서 작동된 코드가 제대로 동작하는지 시스템을 만드는 여러 관계자들이 확인을 하고 이상이 없는지 확인하는 서버이다.

#### 프로덕션 환경
- 개발한 코드가 고객들에게 서비스 되는 서버이다.
- 개발한 코드가 검증환경에서 동작의 이상이 없다고 시스템을 만드는 관계자들의 확인이 끝나면 프로덕션 환경에 적용된다.

### 로컬, 검증, 프로덕션 환경은 서로 다른 데이터베이스이다.
- 데이터베이스는 데이터를 저장하기 위해 사용하는 곳이다.
- 로컬, 검증, 프로덕션 환경의 데이터는 서로 다르다. 프로덕션 환경은 서비스를 이용하는 유저들이 생성하고 활동한 정보를 저장하며, 검증환경은 서비스의 동작을 체크하기 위해 생성한 테스트용 데이터를 저장한다. 로컬 환경은 개발자가 개발하면서 동작의 실행 여부를 확인하기 위한 데이터를 저장한다.
- 각 환경에서 저장되어야 하는 데이터가 다르다. 로컬 환경의 데이터가 검증 환경의 데이터와 섞이지 않게 하고, 검증 환경의 데이터가 프로덕션 환경의 데이터와 섞이지 않게 하기 위해서 저장되는 공간을 분리해야 한다. 따라서 서로 다른 데이터베이스를 사용하며 데이터가 저장되는 공간을 독립적으로 하며 데이터의 저장을 격리한다.
- 하지만, 로컬에서 개발된 사항은, 검증환경에 적용이 되고, 검증을 통과한 코드는 프로덕션 환경에 적용되기 때문에 로컬-검증-프로덕션 환경의 데이터베이스의 구성은 일치되는 것을 추구한다.

### 테이터베이스
- 데이터베이스는 테이블을 만드는 곳이다.
- 테이블에는 여러 컬럼이 존재하고 이 컬럼은 데이터의 특성을 기재한다.
- 테이블에는 데이터를 저장하고 이 데이터는 테이블에 정의한 컬럼에 해당하는 값을 갖는다.

#### 스키마
- 스키마는 데이터베이스의 구조를 의미한다. 데이터의 특성을 정의하기 위한 테이블의 테이블 및 컬럼 등의 구성을 의미한다.

### 마이그레이션
- 마이그레이션의 사전적인 의미는 '이주'이다.
- 마이그레이션이란 한 시스템의 구성과 데이터를 다른 곳으로 옮길 때 사용하는 개념이다. 이런 종류의 작업에 마이그레이션이라는 명칭을 붙인다.
- 윈도우 10을 사용하는 유저들에게 컴퓨터에 저장된 파일을 보존한채 윈도우 11로 옮기는 과정도 마이그레이션이라고 부른다.
- 데이터베이스 마이그레이션이란 개념도 있는데 하나의 데이터베이스의 스키마와 데이터를 다른 데이터베이스에 고스란히 옮기는 작업을 의미한다.

### 웹 프레임워크에서 마이그레이션
- 웹 프레임워크에서 마이그레이션은 데이터베이스의 스키마를 로컬환경, 검증환경, 프로덕션 환경에서 데이터베이스의 스키마를 동일하게 유지하기 위해 사용하는 개념이다.
- 개발 환경에서 데이터베이스의 구성을 변경을 하게 되면, 이름 검증환경에 적용하게 되고, 검증을 통과한 코드는 프로덕션 환경에 적용이 된다. 최종적으로는 로컬, 검증, 프로덕션 환경의 데이터베이스 구조를 일치시키려고 하는 것이다.
- 웹 프로그래밍은 주로 데이터베이스에서 데이터를 가져오는 기능을 중심으로 구성된다. 만약 동일한 코드에 서로 다른 구조의 스키마를 가지고 있는 데이터베이스를 이용한다면 한 쪽에서는 잘 동작하는 기능이더라도 다른 쪽에서는 코드에 맞는 데이터베이스 스키마가 구비되지 않아 에러가 발생할 수 있다. 따라서 한 쪽에서 동작하는 코드를 다른 쪽에서도 동작하도록 하기 위해서는 데이터베이스의 스키마를 일치시킬 필요성이 있다.
- 기본적으로 데이터베이스의 스키마는 쿼리로 정의한다. 로컬 환경에서 데이터베이스의 스키마를 변경시키기 위해서 사용한 쿼리는 그대로 검증환경에 동일하게 적용하여 로컬환경에서 개발한 스키마와 동일하게 검증환경에 적용해 주어야 한다. 그래야 개발한 코드의 동작이 검증 환경에서도 동일하게 동작할 것이기 때문이다. 또한 검증 환경을 통과했다면 로컬 환경과 검증환경에서 데이터베이스의 스키마 변경을 위해 사용한 쿼리는 그대로 프로덕션 환경에 적용 해 주어야 프로덕션 환경의 동작과 로컬 환경의 동작을 일치시킬 수 있다.
- 이렇게 로컬, 검증, 프로덕션 환경에서 동일한 데이터베이스 스키마를 가질 수 있도록 하기 위해서는 최종적인 스키마의 모습이 아니라, 스키마를 변경하기 위해 적용한 각각의 쿼리 모두를 기록해서 순차적으로 적용해야한다.